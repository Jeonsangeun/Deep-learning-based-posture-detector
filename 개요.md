# Deep-learning-based-posture-detector
다중 IMU 센서를사용한 Multi-Class Classification 연구

### 1. 초기 시작 연구 (2019.11.14)
교내에서 실시한 데모크라우드펀딩 창업경진대회에서 본 연구의 아이디어를 처음으로 제시하였다.
신체 각 부위에 다중 IMU센서를 부착한 웨어러블 디바이스를 제작하여 각 센서들의 오일러 각도 데이터에 대한 분석을 딥러닝으로 구현하고자 하였다.
#### 1.1. 나의 역활
이 기간은 아이디어 공모전이였기에 구체적인 제작 계획 및 디자인은 고려하지않았다.
난 각 센서들의 다중 통신과 센서 제어에 대한 자료조사를 담당하였다.

### 2. 본격적인 연구 도입 (2020.03.01)
학과과 LINC+사업단이 지원해주는 융합 캡스톤 디자인을 참가하게 되면서 아이디어 구현의 초석을 다졌다.

#### 2.1. 나의 역활
팀장으로 총 4명의 구성원들과 함께 프로젝트를 진행하였고 주 1회 지도교수님과의 세미나를 통해 구현에 도움을 받았다. 
전체적인 개발계획을 수립하고, 디바이스 제작과 데이터 학습을 주로 시도하였다.
#### 2.2 디바이스 제작과정
초기 아이디어였던 웨어러블 디바이스에 포커싱을 맞추었다. 주로 허리 질환관련 자세분류를 위해 상의에 센서를 박을 생각이였다.
![예상](https://user-images.githubusercontent.com/44052428/114373133-409bab00-9bbd-11eb-86af-cf2616144fd2.png)
의상이 신체에 밀착되어야 정밀한 센서값을 출력할 수 있으므로 자세 교정용 조끼를 구매하였다.
의상 내에는 총 8개의 센서를 장착할 것이며 조끼에 들어갈 회로는 다음과 같다. (진짜 대충 만들었다...)
![회로설계](https://user-images.githubusercontent.com/44052428/114373321-6e80ef80-9bbd-11eb-83aa-82a2acb444f4.jpg)
##### 2.2.1 사용 장비
1. 라즈베리파이4 (I2C 통신을 이용한 데이터 수집, 내장 프로세서로 심층학습, 서버 통신)
2. MPU-6050 (IMU 센서)
3. 자세 교정 조끼
##### 2.2.2 제작
초기 과정에서는 데이터 받는것을 목표로 하였기 때문에 유선 연결을 시도하였다.

![임시회로](https://user-images.githubusercontent.com/44052428/114374462-a0df1c80-9bbe-11eb-9011-158fa4959b43.jpg)

라즈베리파이와의 통신 확인 이후 본격 제작하였다.

![이어붙이기](https://user-images.githubusercontent.com/44052428/114374491-a6d4fd80-9bbe-11eb-936b-c427786f17e2.jpg)

##### 2.2.3 구현 요약
![과정](https://user-images.githubusercontent.com/44052428/114374895-16e38380-9bbf-11eb-9c17-4d814f995bba.png)

#### 2.3 결과
1초당 20번의 디지털 센서값들을 받아와 총 8개의 자세를 분류하는 신경망을 설계한다. 
입력 : (20, 8, 3) Tensor
출력 : (8) Tensor
은닉층 : 3개 (출력층으로 갈 수록 작아지는..) Code에 있다...
Hidden layer의 활성함수에 따른 학습결과를 그림으로 보인다.

![결과](https://user-images.githubusercontent.com/44052428/114376194-5ced1700-9bc0-11eb-962c-fdd4cd298cba.png)

ELU 레이어의 성능이 가장 좋았으며 Train_accuracy와 loss는 다음과 같더라.
![ELU](https://user-images.githubusercontent.com/44052428/114376188-5bbbea00-9bc0-11eb-8ce0-430ee74663f8.png)
어플리케이션을 통한 실시간 자세 결과 조회 서비스와 누적 자세 분석 서비스도 만들었다.

##### 2.3.1 수상
학과 융합캡스톤디자인 2등과 대한임베디드공학회 대학생 우수논문 발표상을 수상하였다.

### 3. X-corps 동남권 지역산업 밀착형 실전문제연구단 (2020.06.16)
본교 공과대 학생을 대상으로 하는 실전문제연구단 사업으로 다시 이 연구를 보강하였다.
실전문제연구단은 팀원으로 대학원생과 대학생, 멘토로 지도 교수님과 산업체 멘토가 하나의 연구팀을 구성하여 하고자 하는 연구를 본격적으로 시도할 수 있었다. 

#### 3.1. 나의 역활
석사과정에 입학하여 대학원생으로 팀장을 맡았고 이전 프로젝트에 이어 전체적인 연구진행을 이끌었다.
본 연구에서는 이전 연구에서의 유선 방식을 탈출하고 무선통신을 통한 데이터 수집 및 학습진행에 포커스를 맞추었다. 
#### 3.2 디바이스 제작과정
이전과 달리 Half-Wireless Product를 제작하는 것을 목표로 하였다. 웨어러블 디바이스와 데이터 학습을 진행하는 프로세서 사이 통신을 무선으로 (소켓통신)으로 수정하였다.
학습은 이전 연구와 동일한 심층학습을 사용할 것이고 적은 데이터로 분류문제의 정확도를 높힐 수 있도록 전이 학습 & Generative Adversarial Network을 활용하기 위해 공부하였다.
![System_model](https://user-images.githubusercontent.com/44052428/114378840-11883800-9bc3-11eb-9131-6e127dcc8ef9.png)
##### 3.2.1 사용 장비
1. 라즈베리파이 Zero W (소형 MCU로 웨어러블 디바이스를 입었을때 불편함이 없는 사이즈, 데이터 수집용도)
2. MPU-6050 (IMU 센서)
3. 자세 교정 조끼
##### 2.2.2 제작
